<meta charset="utf-8"/>
<script type='module' src='https://git.max.pub/JSON-view/dist/json-view.tag.js'></script>

<main>
    <h1>Pharma Info</h1>
    <div id='lang'>
        <span>de</span>
        <span>en</span>
        <span>es</span>
    </div>
    <div id='input'>
        <div id='tags'></div>
        <textarea placeholder="list of pharmacons here. comma or newline separated"></textarea>
    </div>
    <button>search</button>
    <json-view id='output'></json-view>
</main>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Quicksand&display=swap');
    * {font-family: Quicksand; box-sizing: border-box;}
    h1{text-align: center;}
    body{background:#333;}
    main{width:100%; max-width: 40rem; margin: 0 auto; color: white; padding: 1rem;}
    #lang{text-align: center; margin:2rem;}
    #input, #output{background: #444; width: 100%;}
    textarea{background:transparent; outline: none; border:none; width: 100%;height: 5rem; color: white; text-align: center; padding:.5rem;}
    #tags{text-align: center;}
    #tags>span{display: inline-block; padding:.3rem; margin:.3rem; background:#333; border-radius: 5px;}
    button{display: block; margin: 1rem auto; padding:.5rem; background:#444; border:none; color: white; font-size:1.3rem; }
</style>

<script>

    document.querySelector('textarea').addEventListener('blur',e=>{
        addTags(e.target.value)
    })
    window.addEventListener('paste',e=>{
        addTags((event.clipboardData || window.clipboardData).getData('text'));
        e.preventDefault();
        return false;
    })

    function addTags(string){
        document.querySelector('#tags').innerHTML += string.split(',').map(x=>x.trim()).map(x=>`<span>${x}</span>`).join('\n')
    }


    document.querySelector('button').addEventListener('click',e=>{
        search()
    })

    async function search(){
        let query = Array.from(document.querySelectorAll('#tags span')).map(x=>x.textContent);
        console.log('query',query);
        let result = await fetch(`/de/${query[0]}`).then(x=>x.text())
        document.querySelector('#output').innerHTML = result;
    }




</script>